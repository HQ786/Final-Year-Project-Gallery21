"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/auth/[...nextauth]/route";
exports.ids = ["app/api/auth/[...nextauth]/route"];
exports.modules = {

/***/ "mongoose":
/*!***************************!*\
  !*** external "mongoose" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("mongoose");

/***/ }),

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "assert":
/*!*************************!*\
  !*** external "assert" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("assert");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "querystring":
/*!******************************!*\
  !*** external "querystring" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("querystring");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&page=%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute.js&appDir=%2FVolumes%2FMySecureSphere%2FFYP%20Code%2Fgallery21-main%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FVolumes%2FMySecureSphere%2FFYP%20Code%2Fgallery21-main&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&page=%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute.js&appDir=%2FVolumes%2FMySecureSphere%2FFYP%20Code%2Fgallery21-main%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FVolumes%2FMySecureSphere%2FFYP%20Code%2Fgallery21-main&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Volumes_MySecureSphere_FYP_Code_gallery21_main_app_api_auth_nextauth_route_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/auth/[...nextauth]/route.js */ \"(rsc)/./app/api/auth/[...nextauth]/route.js\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/auth/[...nextauth]/route\",\n        pathname: \"/api/auth/[...nextauth]\",\n        filename: \"route\",\n        bundlePath: \"app/api/auth/[...nextauth]/route\"\n    },\n    resolvedPagePath: \"/Volumes/MySecureSphere/FYP Code/gallery21-main/app/api/auth/[...nextauth]/route.js\",\n    nextConfigOutput,\n    userland: _Volumes_MySecureSphere_FYP_Code_gallery21_main_app_api_auth_nextauth_route_js__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/auth/[...nextauth]/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhdXRoJTJGJTVCLi4ubmV4dGF1dGglNUQlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmF1dGglMkYlNUIuLi5uZXh0YXV0aCU1RCUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmF1dGglMkYlNUIuLi5uZXh0YXV0aCU1RCUyRnJvdXRlLmpzJmFwcERpcj0lMkZWb2x1bWVzJTJGTXlTZWN1cmVTcGhlcmUlMkZGWVAlMjBDb2RlJTJGZ2FsbGVyeTIxLW1haW4lMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRlZvbHVtZXMlMkZNeVNlY3VyZVNwaGVyZSUyRkZZUCUyMENvZGUlMkZnYWxsZXJ5MjEtbWFpbiZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDbUM7QUFDaEg7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9nYWxsZXJ5MjEtd2ViLWFwcC0yLjAvPzYwZTMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL1ZvbHVtZXMvTXlTZWN1cmVTcGhlcmUvRllQIENvZGUvZ2FsbGVyeTIxLW1haW4vYXBwL2FwaS9hdXRoL1suLi5uZXh0YXV0aF0vcm91dGUuanNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2F1dGgvWy4uLm5leHRhdXRoXS9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2F1dGgvWy4uLm5leHRhdXRoXVwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvYXV0aC9bLi4ubmV4dGF1dGhdL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL1ZvbHVtZXMvTXlTZWN1cmVTcGhlcmUvRllQIENvZGUvZ2FsbGVyeTIxLW1haW4vYXBwL2FwaS9hdXRoL1suLi5uZXh0YXV0aF0vcm91dGUuanNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL2F1dGgvWy4uLm5leHRhdXRoXS9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&page=%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute.js&appDir=%2FVolumes%2FMySecureSphere%2FFYP%20Code%2Fgallery21-main%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FVolumes%2FMySecureSphere%2FFYP%20Code%2Fgallery21-main&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/auth/[...nextauth]/route.js":
/*!*********************************************!*\
  !*** ./app/api/auth/[...nextauth]/route.js ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ handler),\n/* harmony export */   POST: () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _models_User__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @models/User */ \"(rsc)/./models/User.js\");\n/* harmony import */ var _utils_database__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @utils/database */ \"(rsc)/./utils/database.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(bcryptjs__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next-auth */ \"(rsc)/./node_modules/next-auth/index.js\");\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(next_auth__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var next_auth_providers_google__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! next-auth/providers/google */ \"(rsc)/./node_modules/next-auth/providers/google.js\");\n/* harmony import */ var next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! next-auth/providers/credentials */ \"(rsc)/./node_modules/next-auth/providers/credentials.js\");\n\n\n\n\n\n\nconst handler = next_auth__WEBPACK_IMPORTED_MODULE_3___default()({\n    providers: [\n        (0,next_auth_providers_google__WEBPACK_IMPORTED_MODULE_4__[\"default\"])({\n            clientId: process.env.GOOGLE_CLIENT_ID,\n            clientSecret: process.env.GOOGLE_CLIENT_SECRET,\n            authorization: {\n                params: {\n                    prompt: \"consent\",\n                    access_type: \"offline\",\n                    response_type: \"code\"\n                }\n            }\n        }),\n        (0,next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_5__[\"default\"])({\n            name: \"Credentials\",\n            async authorize (credentials) {\n                try {\n                    await (0,_utils_database__WEBPACK_IMPORTED_MODULE_1__.connectToDB)();\n                    const { emailOrUsername, password } = credentials;\n                    if (!emailOrUsername || !password) {\n                        throw new Error(\"Email/Username and password are required\");\n                    }\n                    let user;\n                    // Determine if the input is an email (contains '@') or a username\n                    if (emailOrUsername.includes(\"@\")) {\n                        user = await _models_User__WEBPACK_IMPORTED_MODULE_0__[\"default\"].findOne({\n                            email: emailOrUsername\n                        });\n                    } else {\n                        user = await _models_User__WEBPACK_IMPORTED_MODULE_0__[\"default\"].findOne({\n                            username: emailOrUsername\n                        });\n                    }\n                    console.log(user);\n                    if (!user) {\n                        throw new Error(\"User not found\");\n                    }\n                    // Compare the entered password with the stored hashed password\n                    const isPasswordValid = await bcryptjs__WEBPACK_IMPORTED_MODULE_2___default().compare(password, user.password);\n                    console.log(password, user.password);\n                    if (!isPasswordValid) {\n                        throw new Error(\"Invalid password\");\n                    }\n                    // Return the user object if login is successful\n                    return {\n                        id: user._id.toString(),\n                        email: user.email,\n                        username: user.username,\n                        roles: user.roles,\n                        isVerified: user.isVerified\n                    };\n                } catch (error) {\n                    console.error(\"Error in manual login:\", error.message);\n                    if (error.name === \"TimeoutError\" || error.message.includes(\"timed out\")) {\n                        throw new Error(\"Login request timed out. Please try again.\");\n                    } else {\n                        throw new Error(error.message || \"Login failed\");\n                    }\n                }\n            }\n        })\n    ],\n    secret: process.env.NEXTAUTH_SECRET,\n    session: {\n        strategy: \"jwt\",\n        maxAge: 24 * 60 * 60\n    },\n    // cookies: {\n    //   sessionToken: {\n    //     name: `__Secure-next-auth.session-token`,\n    //     options: {\n    //       httpOnly: true,\n    //       sameSite: \"lax\",\n    //       path: \"/\",\n    //       secure: process.env.NODE_ENV === \"production\", // Ensure secure cookies in production\n    //       maxAge: 24 * 60 * 60, // Match the maxAge of the session\n    //     },\n    //   },\n    // },  \n    callbacks: {\n        async session ({ session, token }) {\n            // Attach user ID and other data to the session\n            if (token) {\n                session.user.id = token.id;\n                session.user.email = token.email;\n                session.user.username = token.username;\n                session.user.isVerified = token.isVerified;\n                session.user.roles = token.roles;\n            }\n            return session;\n        },\n        async jwt ({ token, user }) {\n            // Store user data in JWT token\n            if (user) {\n                token.id = user.id;\n                token.email = user.email;\n                token.username = user.username;\n                token.isVerified = user.isVerified;\n                token.roles = user.roles;\n            }\n            // Set token expiry (in seconds)\n            const expirationTime = Math.floor(Date.now() / 1000) + 60 * 60 * 24; // 24 hours\n            token.exp = expirationTime;\n            return token;\n        }\n    }\n});\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2F1dGgvWy4uLm5leHRhdXRoXS9yb3V0ZS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBQWdDO0FBQ2M7QUFDaEI7QUFDRztBQUN1QjtBQUNVO0FBRWxFLE1BQU1NLFVBQVVILGdEQUFRQSxDQUFDO0lBQ3ZCSSxXQUFXO1FBQ1RILHNFQUFjQSxDQUFDO1lBQ2JJLFVBQVVDLFFBQVFDLEdBQUcsQ0FBQ0MsZ0JBQWdCO1lBQ3RDQyxjQUFjSCxRQUFRQyxHQUFHLENBQUNHLG9CQUFvQjtZQUM5Q0MsZUFBZTtnQkFDYkMsUUFBUTtvQkFDTkMsUUFBUTtvQkFDUkMsYUFBYTtvQkFDYkMsZUFBZTtnQkFDakI7WUFDRjtRQUNGO1FBQ0FiLDJFQUFtQkEsQ0FBQztZQUNsQmMsTUFBTTtZQUNOLE1BQU1DLFdBQVVDLFdBQVc7Z0JBQ3pCLElBQUk7b0JBQ0YsTUFBTXBCLDREQUFXQTtvQkFFakIsTUFBTSxFQUFFcUIsZUFBZSxFQUFFQyxRQUFRLEVBQUUsR0FBR0Y7b0JBRXRDLElBQUksQ0FBQ0MsbUJBQW1CLENBQUNDLFVBQVU7d0JBQ2pDLE1BQU0sSUFBSUMsTUFBTTtvQkFDbEI7b0JBRUEsSUFBSUM7b0JBQ0osa0VBQWtFO29CQUNsRSxJQUFJSCxnQkFBZ0JJLFFBQVEsQ0FBQyxNQUFNO3dCQUNqQ0QsT0FBTyxNQUFNekIsb0RBQUlBLENBQUMyQixPQUFPLENBQUM7NEJBQUVDLE9BQU9OO3dCQUFnQjtvQkFDckQsT0FBTzt3QkFDTEcsT0FBTyxNQUFNekIsb0RBQUlBLENBQUMyQixPQUFPLENBQUM7NEJBQUVFLFVBQVVQO3dCQUFnQjtvQkFDeEQ7b0JBQ0FRLFFBQVFDLEdBQUcsQ0FBQ047b0JBRVosSUFBSSxDQUFDQSxNQUFNO3dCQUNULE1BQU0sSUFBSUQsTUFBTTtvQkFDbEI7b0JBRUEsK0RBQStEO29CQUMvRCxNQUFNUSxrQkFBa0IsTUFBTTlCLHVEQUFjLENBQUNxQixVQUFVRSxLQUFLRixRQUFRO29CQUNwRU8sUUFBUUMsR0FBRyxDQUFDUixVQUFVRSxLQUFLRixRQUFRO29CQUNuQyxJQUFJLENBQUNTLGlCQUFpQjt3QkFDcEIsTUFBTSxJQUFJUixNQUFNO29CQUNsQjtvQkFFQSxnREFBZ0Q7b0JBQ2hELE9BQU87d0JBQ0xVLElBQUlULEtBQUtVLEdBQUcsQ0FBQ0MsUUFBUTt3QkFDckJSLE9BQU9ILEtBQUtHLEtBQUs7d0JBQ2pCQyxVQUFVSixLQUFLSSxRQUFRO3dCQUN2QlEsT0FBT1osS0FBS1ksS0FBSzt3QkFDakJDLFlBQVliLEtBQUthLFVBQVU7b0JBQzdCO2dCQUNGLEVBQUUsT0FBT0MsT0FBTztvQkFDZFQsUUFBUVMsS0FBSyxDQUFDLDBCQUEwQkEsTUFBTUMsT0FBTztvQkFDckQsSUFBSUQsTUFBTXBCLElBQUksS0FBSyxrQkFBa0JvQixNQUFNQyxPQUFPLENBQUNkLFFBQVEsQ0FBQyxjQUFjO3dCQUN4RSxNQUFNLElBQUlGLE1BQU07b0JBQ2xCLE9BQU87d0JBQ0wsTUFBTSxJQUFJQSxNQUFNZSxNQUFNQyxPQUFPLElBQUk7b0JBQ25DO2dCQUNGO1lBQ0Y7UUFDRjtLQUNEO0lBQ0RDLFFBQVFoQyxRQUFRQyxHQUFHLENBQUNnQyxlQUFlO0lBQ25DQyxTQUFTO1FBQ1BDLFVBQVU7UUFDVkMsUUFBUSxLQUFLLEtBQUs7SUFDcEI7SUFDQSxhQUFhO0lBQ2Isb0JBQW9CO0lBQ3BCLGdEQUFnRDtJQUNoRCxpQkFBaUI7SUFDakIsd0JBQXdCO0lBQ3hCLHlCQUF5QjtJQUN6QixtQkFBbUI7SUFDbkIsOEZBQThGO0lBQzlGLGlFQUFpRTtJQUNqRSxTQUFTO0lBQ1QsT0FBTztJQUNQLE9BQU87SUFDUEMsV0FBVztRQUNULE1BQU1ILFNBQVEsRUFBRUEsT0FBTyxFQUFFSSxLQUFLLEVBQUU7WUFDOUIsK0NBQStDO1lBQy9DLElBQUlBLE9BQU87Z0JBQ1RKLFFBQVFsQixJQUFJLENBQUNTLEVBQUUsR0FBR2EsTUFBTWIsRUFBRTtnQkFDMUJTLFFBQVFsQixJQUFJLENBQUNHLEtBQUssR0FBR21CLE1BQU1uQixLQUFLO2dCQUNoQ2UsUUFBUWxCLElBQUksQ0FBQ0ksUUFBUSxHQUFHa0IsTUFBTWxCLFFBQVE7Z0JBQ3RDYyxRQUFRbEIsSUFBSSxDQUFDYSxVQUFVLEdBQUdTLE1BQU1ULFVBQVU7Z0JBQzFDSyxRQUFRbEIsSUFBSSxDQUFDWSxLQUFLLEdBQUdVLE1BQU1WLEtBQUs7WUFDbEM7WUFDQSxPQUFPTTtRQUNUO1FBQ0EsTUFBTUssS0FBSSxFQUFFRCxLQUFLLEVBQUV0QixJQUFJLEVBQUU7WUFDdkIsK0JBQStCO1lBQy9CLElBQUlBLE1BQU07Z0JBQ1JzQixNQUFNYixFQUFFLEdBQUdULEtBQUtTLEVBQUU7Z0JBQ2xCYSxNQUFNbkIsS0FBSyxHQUFHSCxLQUFLRyxLQUFLO2dCQUN4Qm1CLE1BQU1sQixRQUFRLEdBQUdKLEtBQUtJLFFBQVE7Z0JBQzlCa0IsTUFBTVQsVUFBVSxHQUFHYixLQUFLYSxVQUFVO2dCQUNsQ1MsTUFBTVYsS0FBSyxHQUFHWixLQUFLWSxLQUFLO1lBRTFCO1lBQ0EsZ0NBQWdDO1lBQ2hDLE1BQU1ZLGlCQUFpQkMsS0FBS0MsS0FBSyxDQUFDQyxLQUFLQyxHQUFHLEtBQUssUUFBUSxLQUFLLEtBQUssSUFBSSxXQUFXO1lBQ2hGTixNQUFNTyxHQUFHLEdBQUdMO1lBRVosT0FBT0Y7UUFDVDtJQUNGO0FBQ0Y7QUFFMkMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9nYWxsZXJ5MjEtd2ViLWFwcC0yLjAvLi9hcHAvYXBpL2F1dGgvWy4uLm5leHRhdXRoXS9yb3V0ZS5qcz9kYTFhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBVc2VyIGZyb20gXCJAbW9kZWxzL1VzZXJcIjtcbmltcG9ydCB7IGNvbm5lY3RUb0RCIH0gZnJvbSBcIkB1dGlscy9kYXRhYmFzZVwiO1xuaW1wb3J0IGJjcnlwdCBmcm9tIFwiYmNyeXB0anNcIjtcbmltcG9ydCBOZXh0QXV0aCBmcm9tIFwibmV4dC1hdXRoXCI7XG5pbXBvcnQgR29vZ2xlUHJvdmlkZXIgZnJvbSBcIm5leHQtYXV0aC9wcm92aWRlcnMvZ29vZ2xlXCI7XG5pbXBvcnQgQ3JlZGVudGlhbHNQcm92aWRlciBmcm9tIFwibmV4dC1hdXRoL3Byb3ZpZGVycy9jcmVkZW50aWFsc1wiO1xuXG5jb25zdCBoYW5kbGVyID0gTmV4dEF1dGgoe1xuICBwcm92aWRlcnM6IFtcbiAgICBHb29nbGVQcm92aWRlcih7XG4gICAgICBjbGllbnRJZDogcHJvY2Vzcy5lbnYuR09PR0xFX0NMSUVOVF9JRCxcbiAgICAgIGNsaWVudFNlY3JldDogcHJvY2Vzcy5lbnYuR09PR0xFX0NMSUVOVF9TRUNSRVQsXG4gICAgICBhdXRob3JpemF0aW9uOiB7XG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIHByb21wdDogXCJjb25zZW50XCIsXG4gICAgICAgICAgYWNjZXNzX3R5cGU6IFwib2ZmbGluZVwiLFxuICAgICAgICAgIHJlc3BvbnNlX3R5cGU6IFwiY29kZVwiLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9KSxcbiAgICBDcmVkZW50aWFsc1Byb3ZpZGVyKHtcbiAgICAgIG5hbWU6IFwiQ3JlZGVudGlhbHNcIixcbiAgICAgIGFzeW5jIGF1dGhvcml6ZShjcmVkZW50aWFscykge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGF3YWl0IGNvbm5lY3RUb0RCKCk7XG5cbiAgICAgICAgICBjb25zdCB7IGVtYWlsT3JVc2VybmFtZSwgcGFzc3dvcmQgfSA9IGNyZWRlbnRpYWxzO1xuXG4gICAgICAgICAgaWYgKCFlbWFpbE9yVXNlcm5hbWUgfHwgIXBhc3N3b3JkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJFbWFpbC9Vc2VybmFtZSBhbmQgcGFzc3dvcmQgYXJlIHJlcXVpcmVkXCIpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGxldCB1c2VyO1xuICAgICAgICAgIC8vIERldGVybWluZSBpZiB0aGUgaW5wdXQgaXMgYW4gZW1haWwgKGNvbnRhaW5zICdAJykgb3IgYSB1c2VybmFtZVxuICAgICAgICAgIGlmIChlbWFpbE9yVXNlcm5hbWUuaW5jbHVkZXMoXCJAXCIpKSB7XG4gICAgICAgICAgICB1c2VyID0gYXdhaXQgVXNlci5maW5kT25lKHsgZW1haWw6IGVtYWlsT3JVc2VybmFtZSB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdXNlciA9IGF3YWl0IFVzZXIuZmluZE9uZSh7IHVzZXJuYW1lOiBlbWFpbE9yVXNlcm5hbWUgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnNvbGUubG9nKHVzZXIpO1xuXG4gICAgICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJVc2VyIG5vdCBmb3VuZFwiKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgXG4gICAgICAgICAgLy8gQ29tcGFyZSB0aGUgZW50ZXJlZCBwYXNzd29yZCB3aXRoIHRoZSBzdG9yZWQgaGFzaGVkIHBhc3N3b3JkXG4gICAgICAgICAgY29uc3QgaXNQYXNzd29yZFZhbGlkID0gYXdhaXQgYmNyeXB0LmNvbXBhcmUocGFzc3dvcmQsIHVzZXIucGFzc3dvcmQpO1xuICAgICAgICAgIGNvbnNvbGUubG9nKHBhc3N3b3JkLCB1c2VyLnBhc3N3b3JkKVxuICAgICAgICAgIGlmICghaXNQYXNzd29yZFZhbGlkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIHBhc3N3b3JkXCIpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIFJldHVybiB0aGUgdXNlciBvYmplY3QgaWYgbG9naW4gaXMgc3VjY2Vzc2Z1bFxuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpZDogdXNlci5faWQudG9TdHJpbmcoKSxcbiAgICAgICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxuICAgICAgICAgICAgdXNlcm5hbWU6IHVzZXIudXNlcm5hbWUsXG4gICAgICAgICAgICByb2xlczogdXNlci5yb2xlcyxcbiAgICAgICAgICAgIGlzVmVyaWZpZWQ6IHVzZXIuaXNWZXJpZmllZCxcbiAgICAgICAgICB9O1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBpbiBtYW51YWwgbG9naW46XCIsIGVycm9yLm1lc3NhZ2UpO1xuICAgICAgICAgIGlmIChlcnJvci5uYW1lID09PSBcIlRpbWVvdXRFcnJvclwiIHx8IGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoXCJ0aW1lZCBvdXRcIikpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkxvZ2luIHJlcXVlc3QgdGltZWQgb3V0LiBQbGVhc2UgdHJ5IGFnYWluLlwiKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yLm1lc3NhZ2UgfHwgXCJMb2dpbiBmYWlsZWRcIik7XG4gICAgICAgICAgfSAgICAgICBcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICB9KSxcbiAgXSxcbiAgc2VjcmV0OiBwcm9jZXNzLmVudi5ORVhUQVVUSF9TRUNSRVQsXG4gIHNlc3Npb246IHtcbiAgICBzdHJhdGVneTogXCJqd3RcIiwgLy8gVXNlIEpXVC1iYXNlZCBzZXNzaW9uc1xuICAgIG1heEFnZTogMjQgKiA2MCAqIDYwLFxuICB9LFxuICAvLyBjb29raWVzOiB7XG4gIC8vICAgc2Vzc2lvblRva2VuOiB7XG4gIC8vICAgICBuYW1lOiBgX19TZWN1cmUtbmV4dC1hdXRoLnNlc3Npb24tdG9rZW5gLFxuICAvLyAgICAgb3B0aW9uczoge1xuICAvLyAgICAgICBodHRwT25seTogdHJ1ZSxcbiAgLy8gICAgICAgc2FtZVNpdGU6IFwibGF4XCIsXG4gIC8vICAgICAgIHBhdGg6IFwiL1wiLFxuICAvLyAgICAgICBzZWN1cmU6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSBcInByb2R1Y3Rpb25cIiwgLy8gRW5zdXJlIHNlY3VyZSBjb29raWVzIGluIHByb2R1Y3Rpb25cbiAgLy8gICAgICAgbWF4QWdlOiAyNCAqIDYwICogNjAsIC8vIE1hdGNoIHRoZSBtYXhBZ2Ugb2YgdGhlIHNlc3Npb25cbiAgLy8gICAgIH0sXG4gIC8vICAgfSxcbiAgLy8gfSwgIFxuICBjYWxsYmFja3M6IHtcbiAgICBhc3luYyBzZXNzaW9uKHsgc2Vzc2lvbiwgdG9rZW4gfSkge1xuICAgICAgLy8gQXR0YWNoIHVzZXIgSUQgYW5kIG90aGVyIGRhdGEgdG8gdGhlIHNlc3Npb25cbiAgICAgIGlmICh0b2tlbikge1xuICAgICAgICBzZXNzaW9uLnVzZXIuaWQgPSB0b2tlbi5pZDtcbiAgICAgICAgc2Vzc2lvbi51c2VyLmVtYWlsID0gdG9rZW4uZW1haWw7XG4gICAgICAgIHNlc3Npb24udXNlci51c2VybmFtZSA9IHRva2VuLnVzZXJuYW1lO1xuICAgICAgICBzZXNzaW9uLnVzZXIuaXNWZXJpZmllZCA9IHRva2VuLmlzVmVyaWZpZWQ7XG4gICAgICAgIHNlc3Npb24udXNlci5yb2xlcyA9IHRva2VuLnJvbGVzO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHNlc3Npb247XG4gICAgfSxcbiAgICBhc3luYyBqd3QoeyB0b2tlbiwgdXNlciB9KSB7XG4gICAgICAvLyBTdG9yZSB1c2VyIGRhdGEgaW4gSldUIHRva2VuXG4gICAgICBpZiAodXNlcikge1xuICAgICAgICB0b2tlbi5pZCA9IHVzZXIuaWQ7XG4gICAgICAgIHRva2VuLmVtYWlsID0gdXNlci5lbWFpbDtcbiAgICAgICAgdG9rZW4udXNlcm5hbWUgPSB1c2VyLnVzZXJuYW1lO1xuICAgICAgICB0b2tlbi5pc1ZlcmlmaWVkID0gdXNlci5pc1ZlcmlmaWVkO1xuICAgICAgICB0b2tlbi5yb2xlcyA9IHVzZXIucm9sZXM7XG5cbiAgICAgIH1cbiAgICAgIC8vIFNldCB0b2tlbiBleHBpcnkgKGluIHNlY29uZHMpXG4gICAgICBjb25zdCBleHBpcmF0aW9uVGltZSA9IE1hdGguZmxvb3IoRGF0ZS5ub3coKSAvIDEwMDApICsgNjAgKiA2MCAqIDI0OyAvLyAyNCBob3Vyc1xuICAgICAgdG9rZW4uZXhwID0gZXhwaXJhdGlvblRpbWU7XG5cbiAgICAgIHJldHVybiB0b2tlbjtcbiAgICB9LFxuICB9LFxufSk7XG5cbmV4cG9ydCB7IGhhbmRsZXIgYXMgR0VULCBoYW5kbGVyIGFzIFBPU1QgfTtcbiJdLCJuYW1lcyI6WyJVc2VyIiwiY29ubmVjdFRvREIiLCJiY3J5cHQiLCJOZXh0QXV0aCIsIkdvb2dsZVByb3ZpZGVyIiwiQ3JlZGVudGlhbHNQcm92aWRlciIsImhhbmRsZXIiLCJwcm92aWRlcnMiLCJjbGllbnRJZCIsInByb2Nlc3MiLCJlbnYiLCJHT09HTEVfQ0xJRU5UX0lEIiwiY2xpZW50U2VjcmV0IiwiR09PR0xFX0NMSUVOVF9TRUNSRVQiLCJhdXRob3JpemF0aW9uIiwicGFyYW1zIiwicHJvbXB0IiwiYWNjZXNzX3R5cGUiLCJyZXNwb25zZV90eXBlIiwibmFtZSIsImF1dGhvcml6ZSIsImNyZWRlbnRpYWxzIiwiZW1haWxPclVzZXJuYW1lIiwicGFzc3dvcmQiLCJFcnJvciIsInVzZXIiLCJpbmNsdWRlcyIsImZpbmRPbmUiLCJlbWFpbCIsInVzZXJuYW1lIiwiY29uc29sZSIsImxvZyIsImlzUGFzc3dvcmRWYWxpZCIsImNvbXBhcmUiLCJpZCIsIl9pZCIsInRvU3RyaW5nIiwicm9sZXMiLCJpc1ZlcmlmaWVkIiwiZXJyb3IiLCJtZXNzYWdlIiwic2VjcmV0IiwiTkVYVEFVVEhfU0VDUkVUIiwic2Vzc2lvbiIsInN0cmF0ZWd5IiwibWF4QWdlIiwiY2FsbGJhY2tzIiwidG9rZW4iLCJqd3QiLCJleHBpcmF0aW9uVGltZSIsIk1hdGgiLCJmbG9vciIsIkRhdGUiLCJub3ciLCJleHAiLCJHRVQiLCJQT1NUIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/auth/[...nextauth]/route.js\n");

/***/ }),

/***/ "(rsc)/./models/User.js":
/*!************************!*\
  !*** ./models/User.js ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(bcryptjs__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! jsonwebtoken */ \"(rsc)/./node_modules/jsonwebtoken/index.js\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\nconst UserSchema = new mongoose__WEBPACK_IMPORTED_MODULE_0__.Schema({\n    firstName: {\n        type: String\n    },\n    lastName: {\n        type: String\n    },\n    username: {\n        type: String,\n        unique: [\n            true,\n            \"Username already exists\"\n        ],\n        required: [\n            true,\n            \"Username is required\"\n        ],\n        maxlength: 20\n    },\n    email: {\n        type: String,\n        unique: [\n            true,\n            \"Email already exists\"\n        ],\n        required: [\n            true,\n            \"Email is required\"\n        ],\n        maxlength: 50\n    },\n    roles: {\n        type: [\n            String\n        ],\n        enum: [\n            \"Novice User\",\n            \"Art Enthusiast\",\n            \"Artist\"\n        ],\n        default: [\n            \"Novice User\"\n        ]\n    },\n    isAdmin: {\n        type: Boolean,\n        default: false\n    },\n    gender: {\n        type: String,\n        enum: [\n            \"male\",\n            \"female\",\n            \"other\"\n        ]\n    },\n    password: {\n        type: String,\n        required: [\n            true,\n            \"Password is required\"\n        ]\n    },\n    profileImagePath: {\n        type: String\n    },\n    isVerified: {\n        type: Boolean,\n        default: false\n    },\n    wishList: {\n        type: Array,\n        default: []\n    },\n    cart: {\n        type: Array,\n        default: []\n    },\n    orders: {\n        type: Array,\n        default: []\n    },\n    artwork: {\n        type: [\n            mongoose__WEBPACK_IMPORTED_MODULE_0__.Schema.Types.ObjectId\n        ],\n        ref: \"Artwork\",\n        default: []\n    },\n    followers: [\n        {\n            type: mongoose__WEBPACK_IMPORTED_MODULE_0__.mongoose.Schema.Types.ObjectId,\n            ref: \"User\",\n            default: []\n        }\n    ],\n    following: [\n        {\n            type: mongoose__WEBPACK_IMPORTED_MODULE_0__.mongoose.Schema.Types.ObjectId,\n            ref: \"User\",\n            default: []\n        }\n    ],\n    joinedForums: [\n        {\n            type: mongoose__WEBPACK_IMPORTED_MODULE_0__.mongoose.Schema.Types.ObjectId,\n            ref: \"Forum\"\n        }\n    ],\n    createdThreads: [\n        {\n            type: mongoose__WEBPACK_IMPORTED_MODULE_0__.mongoose.Schema.Types.ObjectId,\n            ref: \"Thread\"\n        }\n    ],\n    createdComments: [\n        {\n            type: mongoose__WEBPACK_IMPORTED_MODULE_0__.mongoose.Schema.Types.ObjectId,\n            ref: \"Comment\"\n        }\n    ],\n    connectedAccountId: {\n        type: String,\n        default: null\n    },\n    lastUsernameChanged: {\n        type: Date,\n        default: Date.now\n    }\n}, {\n    timestamps: true\n});\n// Add an index for the followers field\nUserSchema.index({\n    followers: 1\n});\n// Add an index for the following field\nUserSchema.index({\n    following: 1\n});\nUserSchema.methods.generatePasswordResetToken = function() {\n    const token = jsonwebtoken__WEBPACK_IMPORTED_MODULE_2___default().sign({\n        id: this._id\n    }, process.env.JWT_SECRET, {\n        expiresIn: \"1h\"\n    });\n    this.passwordResetToken = token; // Add this field to your user model\n    this.passwordResetExpires = Date.now() + 3600000; // 1 hour\n    return token;\n};\n// Middleware to hash password before saving the user\nUserSchema.pre(\"save\", async function(next) {\n    if (this.isModified(\"password\")) {\n        const salt = await bcryptjs__WEBPACK_IMPORTED_MODULE_1___default().genSalt(10);\n        this.password = await bcryptjs__WEBPACK_IMPORTED_MODULE_1___default().hash(this.password, salt);\n    }\n    next();\n});\n// Method to find a user by email and password\nUserSchema.statics.findByCredentials = async function(email, password) {\n    const user = await this.findOne({\n        email\n    });\n    if (!user) {\n        throw new Error(\"User not found\");\n    }\n    if (!await bcryptjs__WEBPACK_IMPORTED_MODULE_1___default().compare(password, user.password)) {\n        throw new Error(\"Incorrect password\");\n    }\n    return user;\n};\nconst User = mongoose__WEBPACK_IMPORTED_MODULE_0__.models.User || (0,mongoose__WEBPACK_IMPORTED_MODULE_0__.model)(\"User\", UserSchema);\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (User);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QVc7SUFBSztJQUNuRixJQUFJLENBQUNDLGtCQUFrQixHQUFHUixPQUFPLG9DQUFvQztJQUNyRSxJQUFJLENBQUNTLG9CQUFvQixHQUFHZixLQUFLQyxHQUFHLEtBQUssU0FBUyxTQUFTO0lBQzNELE9BQU9LO0FBQ1Q7QUFFQSxxREFBcUQ7QUFDckR4QyxXQUFXa0QsR0FBRyxDQUFDLFFBQVEsZUFBZ0JDLElBQUk7SUFDekMsSUFBSSxJQUFJLENBQUNDLFVBQVUsQ0FBQyxhQUFhO1FBQy9CLE1BQU1DLE9BQU8sTUFBTXZELHVEQUFjLENBQUM7UUFDbEMsSUFBSSxDQUFDa0IsUUFBUSxHQUFHLE1BQU1sQixvREFBVyxDQUFDLElBQUksQ0FBQ2tCLFFBQVEsRUFBRXFDO0lBQ25EO0lBQ0FGO0FBQ0Y7QUFFQSw4Q0FBOEM7QUFDOUNuRCxXQUFXd0QsT0FBTyxDQUFDQyxpQkFBaUIsR0FBRyxlQUFnQmhELEtBQUssRUFBRU8sUUFBUTtJQUNwRSxNQUFNMEMsT0FBTyxNQUFNLElBQUksQ0FBQ0MsT0FBTyxDQUFDO1FBQUVsRDtJQUFNO0lBRXhDLElBQUksQ0FBQ2lELE1BQU07UUFDVCxNQUFNLElBQUlFLE1BQU07SUFDbEI7SUFDQSxJQUFJLENBQUMsTUFBTTlELHVEQUFjLENBQUNrQixVQUFVMEMsS0FBSzFDLFFBQVEsR0FBRztRQUNsRCxNQUFNLElBQUk0QyxNQUFNO0lBQ2xCO0lBRUEsT0FBT0Y7QUFDVDtBQUVBLE1BQU1JLE9BQU9sRSw0Q0FBTUEsQ0FBQ2tFLElBQUksSUFBSW5FLCtDQUFLQSxDQUFDLFFBQVFLO0FBRTFDLGlFQUFlOEQsSUFBSUEsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL2dhbGxlcnkyMS13ZWItYXBwLTIuMC8uL21vZGVscy9Vc2VyLmpzPzczNjciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgU2NoZW1hLCBtb2RlbCwgbW9kZWxzLCBtb25nb29zZSB9IGZyb20gXCJtb25nb29zZVwiO1xuaW1wb3J0IGJjcnlwdCBmcm9tIFwiYmNyeXB0anNcIjtcbmltcG9ydCBqd3QgZnJvbSAnanNvbndlYnRva2VuJztcblxuY29uc3QgVXNlclNjaGVtYSA9IG5ldyBTY2hlbWEoe1xuICBmaXJzdE5hbWU6IHsgdHlwZTogU3RyaW5nfSxcbiAgbGFzdE5hbWU6IHsgdHlwZTogU3RyaW5nIH0sXG4gIHVzZXJuYW1lOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIHVuaXF1ZTogW3RydWUsIFwiVXNlcm5hbWUgYWxyZWFkeSBleGlzdHNcIl0sXG4gICAgcmVxdWlyZWQ6IFt0cnVlLCBcIlVzZXJuYW1lIGlzIHJlcXVpcmVkXCJdLFxuICAgIG1heGxlbmd0aDogMjAsXG4gIH0sXG4gIGVtYWlsOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIHVuaXF1ZTogW3RydWUsIFwiRW1haWwgYWxyZWFkeSBleGlzdHNcIl0sXG4gICAgcmVxdWlyZWQ6IFt0cnVlLCBcIkVtYWlsIGlzIHJlcXVpcmVkXCJdLFxuICAgIG1heGxlbmd0aDogNTAsXG4gIH0sXG4gIHJvbGVzOiB7XG4gICAgdHlwZTogW1N0cmluZ10sXG4gICAgZW51bTogWydOb3ZpY2UgVXNlcicsICdBcnQgRW50aHVzaWFzdCcsICdBcnRpc3QnXSxcbiAgICBkZWZhdWx0OiBbJ05vdmljZSBVc2VyJ10sXG4gIH0sXG4gIGlzQWRtaW46IHtcbiAgICB0eXBlOiBCb29sZWFuLFxuICAgIGRlZmF1bHQ6IGZhbHNlLFxuICB9LFxuICBnZW5kZXI6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgZW51bTogW1wibWFsZVwiLCBcImZlbWFsZVwiLCBcIm90aGVyXCJdLFxuICB9LFxuICBwYXNzd29yZDoge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICByZXF1aXJlZDogW3RydWUsIFwiUGFzc3dvcmQgaXMgcmVxdWlyZWRcIl0sXG4gIH0sXG4gIHByb2ZpbGVJbWFnZVBhdGg6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gIH0sXG4gIGlzVmVyaWZpZWQ6IHtcbiAgICB0eXBlOiBCb29sZWFuLFxuICAgIGRlZmF1bHQ6IGZhbHNlLCAvLyBEZWZhdWx0IHRvIGZhbHNlIHVudGlsIHRoZSB1c2VyIHZlcmlmaWVzIHZpYSBPVFBcbiAgfSxcbiAgd2lzaExpc3Q6IHtcbiAgICB0eXBlOiBBcnJheSxcbiAgICBkZWZhdWx0OiBbXSxcbiAgfSxcbiAgY2FydDoge1xuICAgIHR5cGU6IEFycmF5LFxuICAgIGRlZmF1bHQ6IFtdLFxuICB9LFxuICBvcmRlcnM6IHtcbiAgICB0eXBlOiBBcnJheSxcbiAgICBkZWZhdWx0OiBbXSxcbiAgfSxcbiAgYXJ0d29yazoge1xuICAgIHR5cGU6IFtTY2hlbWEuVHlwZXMuT2JqZWN0SWRdLFxuICAgIHJlZjogXCJBcnR3b3JrXCIsXG4gICAgZGVmYXVsdDogW10sXG4gIH0sXG4gIGZvbGxvd2VyczogW3sgXG4gICAgdHlwZTogbW9uZ29vc2UuU2NoZW1hLlR5cGVzLk9iamVjdElkLCBcbiAgICByZWY6IFwiVXNlclwiLFxuICAgIGRlZmF1bHQ6IFtdLFxuICB9XSxcbiAgZm9sbG93aW5nOiBbeyBcbiAgICB0eXBlOiBtb25nb29zZS5TY2hlbWEuVHlwZXMuT2JqZWN0SWQsIFxuICAgIHJlZjogXCJVc2VyXCIsXG4gICAgZGVmYXVsdDogW10sIFxuICB9XSxcbiAgam9pbmVkRm9ydW1zOiBbeyBcbiAgICB0eXBlOiBtb25nb29zZS5TY2hlbWEuVHlwZXMuT2JqZWN0SWQsIFxuICAgIHJlZjogJ0ZvcnVtJyBcbiAgfV0sXG4gIGNyZWF0ZWRUaHJlYWRzOiBbeyBcbiAgICB0eXBlOiBtb25nb29zZS5TY2hlbWEuVHlwZXMuT2JqZWN0SWQsIFxuICAgIHJlZjogJ1RocmVhZCcgXG4gIH1dLFxuICBjcmVhdGVkQ29tbWVudHM6IFt7IFxuICAgIHR5cGU6IG1vbmdvb3NlLlNjaGVtYS5UeXBlcy5PYmplY3RJZCwgcmVmOiAnQ29tbWVudCcgXG4gIH1dLFxuICBjb25uZWN0ZWRBY2NvdW50SWQ6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgZGVmYXVsdDogbnVsbCxcbiAgfSxcbiAgbGFzdFVzZXJuYW1lQ2hhbmdlZDoge1xuICAgIHR5cGU6IERhdGUsXG4gICAgZGVmYXVsdDogRGF0ZS5ub3csXG4gIH0sXG59LCB7IHRpbWVzdGFtcHM6IHRydWUgfSk7XG5cbi8vIEFkZCBhbiBpbmRleCBmb3IgdGhlIGZvbGxvd2VycyBmaWVsZFxuVXNlclNjaGVtYS5pbmRleCh7IGZvbGxvd2VyczogMSB9KTtcblxuLy8gQWRkIGFuIGluZGV4IGZvciB0aGUgZm9sbG93aW5nIGZpZWxkXG5Vc2VyU2NoZW1hLmluZGV4KHsgZm9sbG93aW5nOiAxIH0pO1xuXG5Vc2VyU2NoZW1hLm1ldGhvZHMuZ2VuZXJhdGVQYXNzd29yZFJlc2V0VG9rZW4gPSBmdW5jdGlvbiAoKSB7XG4gIGNvbnN0IHRva2VuID0gand0LnNpZ24oeyBpZDogdGhpcy5faWQgfSwgcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCwgeyBleHBpcmVzSW46ICcxaCcgfSk7XG4gIHRoaXMucGFzc3dvcmRSZXNldFRva2VuID0gdG9rZW47IC8vIEFkZCB0aGlzIGZpZWxkIHRvIHlvdXIgdXNlciBtb2RlbFxuICB0aGlzLnBhc3N3b3JkUmVzZXRFeHBpcmVzID0gRGF0ZS5ub3coKSArIDM2MDAwMDA7IC8vIDEgaG91clxuICByZXR1cm4gdG9rZW47XG59O1xuXG4vLyBNaWRkbGV3YXJlIHRvIGhhc2ggcGFzc3dvcmQgYmVmb3JlIHNhdmluZyB0aGUgdXNlclxuVXNlclNjaGVtYS5wcmUoJ3NhdmUnLCBhc3luYyBmdW5jdGlvbiAobmV4dCkge1xuICBpZiAodGhpcy5pc01vZGlmaWVkKCdwYXNzd29yZCcpKSB7XG4gICAgY29uc3Qgc2FsdCA9IGF3YWl0IGJjcnlwdC5nZW5TYWx0KDEwKTtcbiAgICB0aGlzLnBhc3N3b3JkID0gYXdhaXQgYmNyeXB0Lmhhc2godGhpcy5wYXNzd29yZCwgc2FsdCk7XG4gIH1cbiAgbmV4dCgpO1xufSk7XG5cbi8vIE1ldGhvZCB0byBmaW5kIGEgdXNlciBieSBlbWFpbCBhbmQgcGFzc3dvcmRcblVzZXJTY2hlbWEuc3RhdGljcy5maW5kQnlDcmVkZW50aWFscyA9IGFzeW5jIGZ1bmN0aW9uIChlbWFpbCwgcGFzc3dvcmQpIHtcbiAgY29uc3QgdXNlciA9IGF3YWl0IHRoaXMuZmluZE9uZSh7IGVtYWlsIH0pO1xuICBcbiAgaWYgKCF1c2VyKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdVc2VyIG5vdCBmb3VuZCcpO1xuICB9XG4gIGlmICghYXdhaXQgYmNyeXB0LmNvbXBhcmUocGFzc3dvcmQsIHVzZXIucGFzc3dvcmQpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdJbmNvcnJlY3QgcGFzc3dvcmQnKTtcbiAgfVxuICBcbiAgcmV0dXJuIHVzZXI7XG59O1xuXG5jb25zdCBVc2VyID0gbW9kZWxzLlVzZXIgfHwgbW9kZWwoXCJVc2VyXCIsIFVzZXJTY2hlbWEpO1xuXG5leHBvcnQgZGVmYXVsdCBVc2VyO1xuIl0sIm5hbWVzIjpbIlNjaGVtYSIsIm1vZGVsIiwibW9kZWxzIiwibW9uZ29vc2UiLCJiY3J5cHQiLCJqd3QiLCJVc2VyU2NoZW1hIiwiZmlyc3ROYW1lIiwidHlwZSIsIlN0cmluZyIsImxhc3ROYW1lIiwidXNlcm5hbWUiLCJ1bmlxdWUiLCJyZXF1aXJlZCIsIm1heGxlbmd0aCIsImVtYWlsIiwicm9sZXMiLCJlbnVtIiwiZGVmYXVsdCIsImlzQWRtaW4iLCJCb29sZWFuIiwiZ2VuZGVyIiwicGFzc3dvcmQiLCJwcm9maWxlSW1hZ2VQYXRoIiwiaXNWZXJpZmllZCIsIndpc2hMaXN0IiwiQXJyYXkiLCJjYXJ0Iiwib3JkZXJzIiwiYXJ0d29yayIsIlR5cGVzIiwiT2JqZWN0SWQiLCJyZWYiLCJmb2xsb3dlcnMiLCJmb2xsb3dpbmciLCJqb2luZWRGb3J1bXMiLCJjcmVhdGVkVGhyZWFkcyIsImNyZWF0ZWRDb21tZW50cyIsImNvbm5lY3RlZEFjY291bnRJZCIsImxhc3RVc2VybmFtZUNoYW5nZWQiLCJEYXRlIiwibm93IiwidGltZXN0YW1wcyIsImluZGV4IiwibWV0aG9kcyIsImdlbmVyYXRlUGFzc3dvcmRSZXNldFRva2VuIiwidG9rZW4iLCJzaWduIiwiaWQiLCJfaWQiLCJwcm9jZXNzIiwiZW52IiwiSldUX1NFQ1JFVCIsImV4cGlyZXNJbiIsInBhc3N3b3JkUmVzZXRUb2tlbiIsInBhc3N3b3JkUmVzZXRFeHBpcmVzIiwicHJlIiwibmV4dCIsImlzTW9kaWZpZWQiLCJzYWx0IiwiZ2VuU2FsdCIsImhhc2giLCJzdGF0aWNzIiwiZmluZEJ5Q3JlZGVudGlhbHMiLCJ1c2VyIiwiZmluZE9uZSIsIkVycm9yIiwiY29tcGFyZSIsIlVzZXIiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./models/User.js\n");

/***/ }),

/***/ "(rsc)/./utils/database.js":
/*!***************************!*\
  !*** ./utils/database.js ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   connectToDB: () => (/* binding */ connectToDB)\n/* harmony export */ });\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongoose */ \"mongoose\");\n/* harmony import */ var mongoose__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongoose__WEBPACK_IMPORTED_MODULE_0__);\n// @utils/database.js\n\nlet isConnected = false;\nconst connectToDB = async ()=>{\n    mongoose__WEBPACK_IMPORTED_MODULE_0___default().set(\"strictQuery\", true);\n    if (isConnected) {\n        console.log(\"MongoDB is already connected\");\n        return (mongoose__WEBPACK_IMPORTED_MODULE_0___default().connection);\n    }\n    try {\n        const connection = await mongoose__WEBPACK_IMPORTED_MODULE_0___default().connect(process.env.MONGODB_URL);\n        isConnected = true;\n        console.log(\"MongoDB connected\");\n        return connection.connection;\n    } catch (error) {\n        console.error(\"Error connecting to MongoDB:\", error);\n        throw new Error(\"Failed to connect to MongoDB\");\n    }\n};\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi91dGlscy9kYXRhYmFzZS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxxQkFBcUI7QUFFVztBQUVoQyxJQUFJQyxjQUFjO0FBRWxCLE1BQU1DLGNBQWM7SUFDbEJGLG1EQUFZLENBQUMsZUFBZTtJQUU1QixJQUFJQyxhQUFhO1FBQ2ZHLFFBQVFDLEdBQUcsQ0FBQztRQUNaLE9BQU9MLDREQUFtQjtJQUM1QjtJQUVBLElBQUk7UUFDRixNQUFNTSxhQUFhLE1BQU1OLHVEQUFnQixDQUFDUSxRQUFRQyxHQUFHLENBQUNDLFdBQVc7UUFFakVULGNBQWM7UUFDZEcsUUFBUUMsR0FBRyxDQUFDO1FBRVosT0FBT0MsV0FBV0EsVUFBVTtJQUM5QixFQUFFLE9BQU9LLE9BQU87UUFDZFAsUUFBUU8sS0FBSyxDQUFDLGdDQUFnQ0E7UUFDOUMsTUFBTSxJQUFJQyxNQUFNO0lBQ2xCO0FBQ0Y7QUFFdUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9nYWxsZXJ5MjEtd2ViLWFwcC0yLjAvLi91dGlscy9kYXRhYmFzZS5qcz8yYjllIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIEB1dGlscy9kYXRhYmFzZS5qc1xyXG5cclxuaW1wb3J0IG1vbmdvb3NlIGZyb20gJ21vbmdvb3NlJztcclxuXHJcbmxldCBpc0Nvbm5lY3RlZCA9IGZhbHNlOyBcclxuXHJcbmNvbnN0IGNvbm5lY3RUb0RCID0gYXN5bmMgKCkgPT4ge1xyXG4gIG1vbmdvb3NlLnNldCgnc3RyaWN0UXVlcnknLCB0cnVlKTtcclxuXHJcbiAgaWYgKGlzQ29ubmVjdGVkKSB7XHJcbiAgICBjb25zb2xlLmxvZygnTW9uZ29EQiBpcyBhbHJlYWR5IGNvbm5lY3RlZCcpO1xyXG4gICAgcmV0dXJuIG1vbmdvb3NlLmNvbm5lY3Rpb247XHJcbiAgfVxyXG5cclxuICB0cnkge1xyXG4gICAgY29uc3QgY29ubmVjdGlvbiA9IGF3YWl0IG1vbmdvb3NlLmNvbm5lY3QocHJvY2Vzcy5lbnYuTU9OR09EQl9VUkwpO1xyXG5cclxuICAgIGlzQ29ubmVjdGVkID0gdHJ1ZTtcclxuICAgIGNvbnNvbGUubG9nKCdNb25nb0RCIGNvbm5lY3RlZCcpO1xyXG5cclxuICAgIHJldHVybiBjb25uZWN0aW9uLmNvbm5lY3Rpb247XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNvbm5lY3RpbmcgdG8gTW9uZ29EQjonLCBlcnJvcik7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBjb25uZWN0IHRvIE1vbmdvREInKTtcclxuICB9XHJcbn07XHJcblxyXG5leHBvcnQgeyBjb25uZWN0VG9EQiB9O1xyXG4iXSwibmFtZXMiOlsibW9uZ29vc2UiLCJpc0Nvbm5lY3RlZCIsImNvbm5lY3RUb0RCIiwic2V0IiwiY29uc29sZSIsImxvZyIsImNvbm5lY3Rpb24iLCJjb25uZWN0IiwicHJvY2VzcyIsImVudiIsIk1PTkdPREJfVVJMIiwiZXJyb3IiLCJFcnJvciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./utils/database.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@opentelemetry","vendor-chunks/next-auth","vendor-chunks/@babel","vendor-chunks/semver","vendor-chunks/bcryptjs","vendor-chunks/jsonwebtoken","vendor-chunks/lodash.includes","vendor-chunks/jws","vendor-chunks/lodash.once","vendor-chunks/jwa","vendor-chunks/lodash.isinteger","vendor-chunks/ecdsa-sig-formatter","vendor-chunks/lodash.isplainobject","vendor-chunks/ms","vendor-chunks/lodash.isstring","vendor-chunks/lodash.isnumber","vendor-chunks/lodash.isboolean","vendor-chunks/safe-buffer","vendor-chunks/buffer-equal-constant-time","vendor-chunks/jose","vendor-chunks/openid-client","vendor-chunks/oauth","vendor-chunks/@panva","vendor-chunks/yallist","vendor-chunks/preact-render-to-string","vendor-chunks/oidc-token-hash","vendor-chunks/preact","vendor-chunks/object-hash","vendor-chunks/lru-cache"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&page=%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute.js&appDir=%2FVolumes%2FMySecureSphere%2FFYP%20Code%2Fgallery21-main%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FVolumes%2FMySecureSphere%2FFYP%20Code%2Fgallery21-main&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();